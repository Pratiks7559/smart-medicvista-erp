<!-- Add this after invoice series select dropdown -->
<div class="series-actions" style="margin-top: 8px; display: flex; gap: 10px;">
    <button type="button" class="btn btn-sm btn-danger" onclick="deleteSelectedSeries()" id="deleteSeriesBtn" style="display: none;">
        <i class="fas fa-trash"></i> Delete Series
    </button>
</div>

<script>
// Show delete button when series is selected
document.getElementById('invoice_series').addEventListener('change', function() {
    const deleteBtn = document.getElementById('deleteSeriesBtn');
    if (this.value) {
        deleteBtn.style.display = 'inline-block';
    } else {
        deleteBtn.style.display = 'none';
    }
});

// Delete selected series
function deleteSelectedSeries() {
    const seriesSelect = document.getElementById('invoice_series');
    const seriesId = seriesSelect.value;
    const seriesName = seriesSelect.options[seriesSelect.selectedIndex].text;
    
    if (!seriesId) {
        alert('Please select a series to delete');
        return;
    }
    
    if (!confirm(`Are you sure you want to delete series "${seriesName}"?`)) {
        return;
    }
    
    fetch(`/api/delete-invoice-series/${seriesId}/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': document.querySelector('[name=csrfmiddlewaretoken]').value
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
            // Remove from dropdown
            seriesSelect.remove(seriesSelect.selectedIndex);
            seriesSelect.value = '';
            document.getElementById('deleteSeriesBtn').style.display = 'none';
            document.getElementById('invoicePreview').style.display = 'none';
        } else {
            alert('Error: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while deleting the series');
    });
}
</script>
